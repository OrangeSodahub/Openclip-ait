
#include "model_container.h"
#include "owned_constants.h"

namespace ait {
namespace {
// Contains the metadata for each constant.
constexpr std::array<ConstantInfo, 4> owned_constants = {
  ConstantInfo{"token_embedding_weight", 0, 0, 50593792},ConstantInfo{"positional_embedding", 50593792, 50593792, 78848},ConstantInfo{"ln_final_weight", 50672640, 50672640, 1024},ConstantInfo{"ln_final_bias", 50673664, 50673664, 1024}
};
} // namespace

ModelContainerBase::ModelContainerBase(
    size_t num_inputs,
    size_t num_outputs,
    size_t num_unbound_constants,
    size_t params_size)
    : constants_(RAII_DeviceMalloc(params_size)),
      num_params_(num_inputs + num_outputs + num_unbound_constants),
      param_names_(num_params_),
      param_dtypes_(num_params_),
      max_param_shapes_(num_params_),
      max_param_numel_(num_params_),
      max_param_storage_bytes_(num_params_) {
     unbound_constant_name_to_idx_["transformer_resblocks_0_ln_1_weight"] = 0;
     unbound_constant_name_to_idx_["transformer_resblocks_0_ln_1_bias"] = 1;
     unbound_constant_name_to_idx_["transformer_resblocks_0_attn_qkv_weight"] = 2;
     unbound_constant_name_to_idx_["transformer_resblocks_0_attn_cu_length"] = 3;
     unbound_constant_name_to_idx_["transformer_resblocks_0_attn_proj_weight"] = 4;
     unbound_constant_name_to_idx_["transformer_resblocks_0_attn_proj_bias"] = 5;
     unbound_constant_name_to_idx_["transformer_resblocks_0_ln_2_weight"] = 6;
     unbound_constant_name_to_idx_["transformer_resblocks_0_ln_2_bias"] = 7;
     unbound_constant_name_to_idx_["transformer_resblocks_0_mlp_c_fc_weight"] = 8;
     unbound_constant_name_to_idx_["transformer_resblocks_0_mlp_c_fc_bias"] = 9;
     unbound_constant_name_to_idx_["transformer_resblocks_0_mlp_c_proj_weight"] = 10;
     unbound_constant_name_to_idx_["transformer_resblocks_0_mlp_c_proj_bias"] = 11;
     unbound_constant_name_to_idx_["transformer_resblocks_1_ln_1_weight"] = 12;
     unbound_constant_name_to_idx_["transformer_resblocks_1_ln_1_bias"] = 13;
     unbound_constant_name_to_idx_["transformer_resblocks_1_attn_qkv_weight"] = 14;
     unbound_constant_name_to_idx_["transformer_resblocks_1_attn_cu_length"] = 15;
     unbound_constant_name_to_idx_["transformer_resblocks_1_attn_proj_weight"] = 16;
     unbound_constant_name_to_idx_["transformer_resblocks_1_attn_proj_bias"] = 17;
     unbound_constant_name_to_idx_["transformer_resblocks_1_ln_2_weight"] = 18;
     unbound_constant_name_to_idx_["transformer_resblocks_1_ln_2_bias"] = 19;
     unbound_constant_name_to_idx_["transformer_resblocks_1_mlp_c_fc_weight"] = 20;
     unbound_constant_name_to_idx_["transformer_resblocks_1_mlp_c_fc_bias"] = 21;
     unbound_constant_name_to_idx_["transformer_resblocks_1_mlp_c_proj_weight"] = 22;
     unbound_constant_name_to_idx_["transformer_resblocks_1_mlp_c_proj_bias"] = 23;
     unbound_constant_name_to_idx_["transformer_resblocks_2_ln_1_weight"] = 24;
     unbound_constant_name_to_idx_["transformer_resblocks_2_ln_1_bias"] = 25;
     unbound_constant_name_to_idx_["transformer_resblocks_2_attn_qkv_weight"] = 26;
     unbound_constant_name_to_idx_["transformer_resblocks_2_attn_cu_length"] = 27;
     unbound_constant_name_to_idx_["transformer_resblocks_2_attn_proj_weight"] = 28;
     unbound_constant_name_to_idx_["transformer_resblocks_2_attn_proj_bias"] = 29;
     unbound_constant_name_to_idx_["transformer_resblocks_2_ln_2_weight"] = 30;
     unbound_constant_name_to_idx_["transformer_resblocks_2_ln_2_bias"] = 31;
     unbound_constant_name_to_idx_["transformer_resblocks_2_mlp_c_fc_weight"] = 32;
     unbound_constant_name_to_idx_["transformer_resblocks_2_mlp_c_fc_bias"] = 33;
     unbound_constant_name_to_idx_["transformer_resblocks_2_mlp_c_proj_weight"] = 34;
     unbound_constant_name_to_idx_["transformer_resblocks_2_mlp_c_proj_bias"] = 35;
     unbound_constant_name_to_idx_["transformer_resblocks_3_ln_1_weight"] = 36;
     unbound_constant_name_to_idx_["transformer_resblocks_3_ln_1_bias"] = 37;
     unbound_constant_name_to_idx_["transformer_resblocks_3_attn_qkv_weight"] = 38;
     unbound_constant_name_to_idx_["transformer_resblocks_3_attn_cu_length"] = 39;
     unbound_constant_name_to_idx_["transformer_resblocks_3_attn_proj_weight"] = 40;
     unbound_constant_name_to_idx_["transformer_resblocks_3_attn_proj_bias"] = 41;
     unbound_constant_name_to_idx_["transformer_resblocks_3_ln_2_weight"] = 42;
     unbound_constant_name_to_idx_["transformer_resblocks_3_ln_2_bias"] = 43;
     unbound_constant_name_to_idx_["transformer_resblocks_3_mlp_c_fc_weight"] = 44;
     unbound_constant_name_to_idx_["transformer_resblocks_3_mlp_c_fc_bias"] = 45;
     unbound_constant_name_to_idx_["transformer_resblocks_3_mlp_c_proj_weight"] = 46;
     unbound_constant_name_to_idx_["transformer_resblocks_3_mlp_c_proj_bias"] = 47;
     unbound_constant_name_to_idx_["transformer_resblocks_4_ln_1_weight"] = 48;
     unbound_constant_name_to_idx_["transformer_resblocks_4_ln_1_bias"] = 49;
     unbound_constant_name_to_idx_["transformer_resblocks_4_attn_qkv_weight"] = 50;
     unbound_constant_name_to_idx_["transformer_resblocks_4_attn_cu_length"] = 51;
     unbound_constant_name_to_idx_["transformer_resblocks_4_attn_proj_weight"] = 52;
     unbound_constant_name_to_idx_["transformer_resblocks_4_attn_proj_bias"] = 53;
     unbound_constant_name_to_idx_["transformer_resblocks_4_ln_2_weight"] = 54;
     unbound_constant_name_to_idx_["transformer_resblocks_4_ln_2_bias"] = 55;
     unbound_constant_name_to_idx_["transformer_resblocks_4_mlp_c_fc_weight"] = 56;
     unbound_constant_name_to_idx_["transformer_resblocks_4_mlp_c_fc_bias"] = 57;
     unbound_constant_name_to_idx_["transformer_resblocks_4_mlp_c_proj_weight"] = 58;
     unbound_constant_name_to_idx_["transformer_resblocks_4_mlp_c_proj_bias"] = 59;
     unbound_constant_name_to_idx_["transformer_resblocks_5_ln_1_weight"] = 60;
     unbound_constant_name_to_idx_["transformer_resblocks_5_ln_1_bias"] = 61;
     unbound_constant_name_to_idx_["transformer_resblocks_5_attn_qkv_weight"] = 62;
     unbound_constant_name_to_idx_["transformer_resblocks_5_attn_cu_length"] = 63;
     unbound_constant_name_to_idx_["transformer_resblocks_5_attn_proj_weight"] = 64;
     unbound_constant_name_to_idx_["transformer_resblocks_5_attn_proj_bias"] = 65;
     unbound_constant_name_to_idx_["transformer_resblocks_5_ln_2_weight"] = 66;
     unbound_constant_name_to_idx_["transformer_resblocks_5_ln_2_bias"] = 67;
     unbound_constant_name_to_idx_["transformer_resblocks_5_mlp_c_fc_weight"] = 68;
     unbound_constant_name_to_idx_["transformer_resblocks_5_mlp_c_fc_bias"] = 69;
     unbound_constant_name_to_idx_["transformer_resblocks_5_mlp_c_proj_weight"] = 70;
     unbound_constant_name_to_idx_["transformer_resblocks_5_mlp_c_proj_bias"] = 71;
     unbound_constant_name_to_idx_["transformer_resblocks_6_ln_1_weight"] = 72;
     unbound_constant_name_to_idx_["transformer_resblocks_6_ln_1_bias"] = 73;
     unbound_constant_name_to_idx_["transformer_resblocks_6_attn_qkv_weight"] = 74;
     unbound_constant_name_to_idx_["transformer_resblocks_6_attn_cu_length"] = 75;
     unbound_constant_name_to_idx_["transformer_resblocks_6_attn_proj_weight"] = 76;
     unbound_constant_name_to_idx_["transformer_resblocks_6_attn_proj_bias"] = 77;
     unbound_constant_name_to_idx_["transformer_resblocks_6_ln_2_weight"] = 78;
     unbound_constant_name_to_idx_["transformer_resblocks_6_ln_2_bias"] = 79;
     unbound_constant_name_to_idx_["transformer_resblocks_6_mlp_c_fc_weight"] = 80;
     unbound_constant_name_to_idx_["transformer_resblocks_6_mlp_c_fc_bias"] = 81;
     unbound_constant_name_to_idx_["transformer_resblocks_6_mlp_c_proj_weight"] = 82;
     unbound_constant_name_to_idx_["transformer_resblocks_6_mlp_c_proj_bias"] = 83;
     unbound_constant_name_to_idx_["transformer_resblocks_7_ln_1_weight"] = 84;
     unbound_constant_name_to_idx_["transformer_resblocks_7_ln_1_bias"] = 85;
     unbound_constant_name_to_idx_["transformer_resblocks_7_attn_qkv_weight"] = 86;
     unbound_constant_name_to_idx_["transformer_resblocks_7_attn_cu_length"] = 87;
     unbound_constant_name_to_idx_["transformer_resblocks_7_attn_proj_weight"] = 88;
     unbound_constant_name_to_idx_["transformer_resblocks_7_attn_proj_bias"] = 89;
     unbound_constant_name_to_idx_["transformer_resblocks_7_ln_2_weight"] = 90;
     unbound_constant_name_to_idx_["transformer_resblocks_7_ln_2_bias"] = 91;
     unbound_constant_name_to_idx_["transformer_resblocks_7_mlp_c_fc_weight"] = 92;
     unbound_constant_name_to_idx_["transformer_resblocks_7_mlp_c_fc_bias"] = 93;
     unbound_constant_name_to_idx_["transformer_resblocks_7_mlp_c_proj_weight"] = 94;
     unbound_constant_name_to_idx_["transformer_resblocks_7_mlp_c_proj_bias"] = 95;
     unbound_constant_name_to_idx_["transformer_resblocks_8_ln_1_weight"] = 96;
     unbound_constant_name_to_idx_["transformer_resblocks_8_ln_1_bias"] = 97;
     unbound_constant_name_to_idx_["transformer_resblocks_8_attn_qkv_weight"] = 98;
     unbound_constant_name_to_idx_["transformer_resblocks_8_attn_cu_length"] = 99;
     unbound_constant_name_to_idx_["transformer_resblocks_8_attn_proj_weight"] = 100;
     unbound_constant_name_to_idx_["transformer_resblocks_8_attn_proj_bias"] = 101;
     unbound_constant_name_to_idx_["transformer_resblocks_8_ln_2_weight"] = 102;
     unbound_constant_name_to_idx_["transformer_resblocks_8_ln_2_bias"] = 103;
     unbound_constant_name_to_idx_["transformer_resblocks_8_mlp_c_fc_weight"] = 104;
     unbound_constant_name_to_idx_["transformer_resblocks_8_mlp_c_fc_bias"] = 105;
     unbound_constant_name_to_idx_["transformer_resblocks_8_mlp_c_proj_weight"] = 106;
     unbound_constant_name_to_idx_["transformer_resblocks_8_mlp_c_proj_bias"] = 107;
     unbound_constant_name_to_idx_["transformer_resblocks_9_ln_1_weight"] = 108;
     unbound_constant_name_to_idx_["transformer_resblocks_9_ln_1_bias"] = 109;
     unbound_constant_name_to_idx_["transformer_resblocks_9_attn_qkv_weight"] = 110;
     unbound_constant_name_to_idx_["transformer_resblocks_9_attn_cu_length"] = 111;
     unbound_constant_name_to_idx_["transformer_resblocks_9_attn_proj_weight"] = 112;
     unbound_constant_name_to_idx_["transformer_resblocks_9_attn_proj_bias"] = 113;
     unbound_constant_name_to_idx_["transformer_resblocks_9_ln_2_weight"] = 114;
     unbound_constant_name_to_idx_["transformer_resblocks_9_ln_2_bias"] = 115;
     unbound_constant_name_to_idx_["transformer_resblocks_9_mlp_c_fc_weight"] = 116;
     unbound_constant_name_to_idx_["transformer_resblocks_9_mlp_c_fc_bias"] = 117;
     unbound_constant_name_to_idx_["transformer_resblocks_9_mlp_c_proj_weight"] = 118;
     unbound_constant_name_to_idx_["transformer_resblocks_9_mlp_c_proj_bias"] = 119;
     unbound_constant_name_to_idx_["transformer_resblocks_10_ln_1_weight"] = 120;
     unbound_constant_name_to_idx_["transformer_resblocks_10_ln_1_bias"] = 121;
     unbound_constant_name_to_idx_["transformer_resblocks_10_attn_qkv_weight"] = 122;
     unbound_constant_name_to_idx_["transformer_resblocks_10_attn_cu_length"] = 123;
     unbound_constant_name_to_idx_["transformer_resblocks_10_attn_proj_weight"] = 124;
     unbound_constant_name_to_idx_["transformer_resblocks_10_attn_proj_bias"] = 125;
     unbound_constant_name_to_idx_["transformer_resblocks_10_ln_2_weight"] = 126;
     unbound_constant_name_to_idx_["transformer_resblocks_10_ln_2_bias"] = 127;
     unbound_constant_name_to_idx_["transformer_resblocks_10_mlp_c_fc_weight"] = 128;
     unbound_constant_name_to_idx_["transformer_resblocks_10_mlp_c_fc_bias"] = 129;
     unbound_constant_name_to_idx_["transformer_resblocks_10_mlp_c_proj_weight"] = 130;
     unbound_constant_name_to_idx_["transformer_resblocks_10_mlp_c_proj_bias"] = 131;
     unbound_constant_name_to_idx_["transformer_resblocks_11_ln_1_weight"] = 132;
     unbound_constant_name_to_idx_["transformer_resblocks_11_ln_1_bias"] = 133;
     unbound_constant_name_to_idx_["transformer_resblocks_11_attn_qkv_weight"] = 134;
     unbound_constant_name_to_idx_["transformer_resblocks_11_attn_cu_length"] = 135;
     unbound_constant_name_to_idx_["transformer_resblocks_11_attn_proj_weight"] = 136;
     unbound_constant_name_to_idx_["transformer_resblocks_11_attn_proj_bias"] = 137;
     unbound_constant_name_to_idx_["transformer_resblocks_11_ln_2_weight"] = 138;
     unbound_constant_name_to_idx_["transformer_resblocks_11_ln_2_bias"] = 139;
     unbound_constant_name_to_idx_["transformer_resblocks_11_mlp_c_fc_weight"] = 140;
     unbound_constant_name_to_idx_["transformer_resblocks_11_mlp_c_fc_bias"] = 141;
     unbound_constant_name_to_idx_["transformer_resblocks_11_mlp_c_proj_weight"] = 142;
     unbound_constant_name_to_idx_["transformer_resblocks_11_mlp_c_proj_bias"] = 143;
     param_names_[0] = "input";
     param_names_[2] = "transformer_resblocks_0_ln_1_weight";
     param_names_[3] = "transformer_resblocks_0_ln_1_bias";
     param_names_[4] = "transformer_resblocks_0_attn_qkv_weight";
     param_names_[5] = "transformer_resblocks_0_attn_cu_length";
     param_names_[6] = "transformer_resblocks_0_attn_proj_weight";
     param_names_[7] = "transformer_resblocks_0_attn_proj_bias";
     param_names_[8] = "transformer_resblocks_0_ln_2_weight";
     param_names_[9] = "transformer_resblocks_0_ln_2_bias";
     param_names_[10] = "transformer_resblocks_0_mlp_c_fc_weight";
     param_names_[11] = "transformer_resblocks_0_mlp_c_fc_bias";
     param_names_[12] = "transformer_resblocks_0_mlp_c_proj_weight";
     param_names_[13] = "transformer_resblocks_0_mlp_c_proj_bias";
     param_names_[14] = "transformer_resblocks_1_ln_1_weight";
     param_names_[15] = "transformer_resblocks_1_ln_1_bias";
     param_names_[16] = "transformer_resblocks_1_attn_qkv_weight";
     param_names_[17] = "transformer_resblocks_1_attn_cu_length";
     param_names_[18] = "transformer_resblocks_1_attn_proj_weight";
     param_names_[19] = "transformer_resblocks_1_attn_proj_bias";
     param_names_[20] = "transformer_resblocks_1_ln_2_weight";
     param_names_[21] = "transformer_resblocks_1_ln_2_bias";
     param_names_[22] = "transformer_resblocks_1_mlp_c_fc_weight";
     param_names_[23] = "transformer_resblocks_1_mlp_c_fc_bias";
     param_names_[24] = "transformer_resblocks_1_mlp_c_proj_weight";
     param_names_[25] = "transformer_resblocks_1_mlp_c_proj_bias";
     param_names_[26] = "transformer_resblocks_2_ln_1_weight";
     param_names_[27] = "transformer_resblocks_2_ln_1_bias";
     param_names_[28] = "transformer_resblocks_2_attn_qkv_weight";
     param_names_[29] = "transformer_resblocks_2_attn_cu_length";
     param_names_[30] = "transformer_resblocks_2_attn_proj_weight";
     param_names_[31] = "transformer_resblocks_2_attn_proj_bias";
     param_names_[32] = "transformer_resblocks_2_ln_2_weight";
     param_names_[33] = "transformer_resblocks_2_ln_2_bias";
     param_names_[34] = "transformer_resblocks_2_mlp_c_fc_weight";
     param_names_[35] = "transformer_resblocks_2_mlp_c_fc_bias";
     param_names_[36] = "transformer_resblocks_2_mlp_c_proj_weight";
     param_names_[37] = "transformer_resblocks_2_mlp_c_proj_bias";
     param_names_[38] = "transformer_resblocks_3_ln_1_weight";
     param_names_[39] = "transformer_resblocks_3_ln_1_bias";
     param_names_[40] = "transformer_resblocks_3_attn_qkv_weight";
     param_names_[41] = "transformer_resblocks_3_attn_cu_length";
     param_names_[42] = "transformer_resblocks_3_attn_proj_weight";
     param_names_[43] = "transformer_resblocks_3_attn_proj_bias";
     param_names_[44] = "transformer_resblocks_3_ln_2_weight";
     param_names_[45] = "transformer_resblocks_3_ln_2_bias";
     param_names_[46] = "transformer_resblocks_3_mlp_c_fc_weight";
     param_names_[47] = "transformer_resblocks_3_mlp_c_fc_bias";
     param_names_[48] = "transformer_resblocks_3_mlp_c_proj_weight";
     param_names_[49] = "transformer_resblocks_3_mlp_c_proj_bias";
     param_names_[50] = "transformer_resblocks_4_ln_1_weight";
     param_names_[51] = "transformer_resblocks_4_ln_1_bias";
     param_names_[52] = "transformer_resblocks_4_attn_qkv_weight";
     param_names_[53] = "transformer_resblocks_4_attn_cu_length";
     param_names_[54] = "transformer_resblocks_4_attn_proj_weight";
     param_names_[55] = "transformer_resblocks_4_attn_proj_bias";
     param_names_[56] = "transformer_resblocks_4_ln_2_weight";
     param_names_[57] = "transformer_resblocks_4_ln_2_bias";
     param_names_[58] = "transformer_resblocks_4_mlp_c_fc_weight";
     param_names_[59] = "transformer_resblocks_4_mlp_c_fc_bias";
     param_names_[60] = "transformer_resblocks_4_mlp_c_proj_weight";
     param_names_[61] = "transformer_resblocks_4_mlp_c_proj_bias";
     param_names_[62] = "transformer_resblocks_5_ln_1_weight";
     param_names_[63] = "transformer_resblocks_5_ln_1_bias";
     param_names_[64] = "transformer_resblocks_5_attn_qkv_weight";
     param_names_[65] = "transformer_resblocks_5_attn_cu_length";
     param_names_[66] = "transformer_resblocks_5_attn_proj_weight";
     param_names_[67] = "transformer_resblocks_5_attn_proj_bias";
     param_names_[68] = "transformer_resblocks_5_ln_2_weight";
     param_names_[69] = "transformer_resblocks_5_ln_2_bias";
     param_names_[70] = "transformer_resblocks_5_mlp_c_fc_weight";
     param_names_[71] = "transformer_resblocks_5_mlp_c_fc_bias";
     param_names_[72] = "transformer_resblocks_5_mlp_c_proj_weight";
     param_names_[73] = "transformer_resblocks_5_mlp_c_proj_bias";
     param_names_[74] = "transformer_resblocks_6_ln_1_weight";
     param_names_[75] = "transformer_resblocks_6_ln_1_bias";
     param_names_[76] = "transformer_resblocks_6_attn_qkv_weight";
     param_names_[77] = "transformer_resblocks_6_attn_cu_length";
     param_names_[78] = "transformer_resblocks_6_attn_proj_weight";
     param_names_[79] = "transformer_resblocks_6_attn_proj_bias";
     param_names_[80] = "transformer_resblocks_6_ln_2_weight";
     param_names_[81] = "transformer_resblocks_6_ln_2_bias";
     param_names_[82] = "transformer_resblocks_6_mlp_c_fc_weight";
     param_names_[83] = "transformer_resblocks_6_mlp_c_fc_bias";
     param_names_[84] = "transformer_resblocks_6_mlp_c_proj_weight";
     param_names_[85] = "transformer_resblocks_6_mlp_c_proj_bias";
     param_names_[86] = "transformer_resblocks_7_ln_1_weight";
     param_names_[87] = "transformer_resblocks_7_ln_1_bias";
     param_names_[88] = "transformer_resblocks_7_attn_qkv_weight";
     param_names_[89] = "transformer_resblocks_7_attn_cu_length";
     param_names_[90] = "transformer_resblocks_7_attn_proj_weight";
     param_names_[91] = "transformer_resblocks_7_attn_proj_bias";
     param_names_[92] = "transformer_resblocks_7_ln_2_weight";
     param_names_[93] = "transformer_resblocks_7_ln_2_bias";
     param_names_[94] = "transformer_resblocks_7_mlp_c_fc_weight";
     param_names_[95] = "transformer_resblocks_7_mlp_c_fc_bias";
     param_names_[96] = "transformer_resblocks_7_mlp_c_proj_weight";
     param_names_[97] = "transformer_resblocks_7_mlp_c_proj_bias";
     param_names_[98] = "transformer_resblocks_8_ln_1_weight";
     param_names_[99] = "transformer_resblocks_8_ln_1_bias";
     param_names_[100] = "transformer_resblocks_8_attn_qkv_weight";
     param_names_[101] = "transformer_resblocks_8_attn_cu_length";
     param_names_[102] = "transformer_resblocks_8_attn_proj_weight";
     param_names_[103] = "transformer_resblocks_8_attn_proj_bias";
     param_names_[104] = "transformer_resblocks_8_ln_2_weight";
     param_names_[105] = "transformer_resblocks_8_ln_2_bias";
     param_names_[106] = "transformer_resblocks_8_mlp_c_fc_weight";
     param_names_[107] = "transformer_resblocks_8_mlp_c_fc_bias";
     param_names_[108] = "transformer_resblocks_8_mlp_c_proj_weight";
     param_names_[109] = "transformer_resblocks_8_mlp_c_proj_bias";
     param_names_[110] = "transformer_resblocks_9_ln_1_weight";
     param_names_[111] = "transformer_resblocks_9_ln_1_bias";
     param_names_[112] = "transformer_resblocks_9_attn_qkv_weight";
     param_names_[113] = "transformer_resblocks_9_attn_cu_length";
     param_names_[114] = "transformer_resblocks_9_attn_proj_weight";
     param_names_[115] = "transformer_resblocks_9_attn_proj_bias";
     param_names_[116] = "transformer_resblocks_9_ln_2_weight";
     param_names_[117] = "transformer_resblocks_9_ln_2_bias";
     param_names_[118] = "transformer_resblocks_9_mlp_c_fc_weight";
     param_names_[119] = "transformer_resblocks_9_mlp_c_fc_bias";
     param_names_[120] = "transformer_resblocks_9_mlp_c_proj_weight";
     param_names_[121] = "transformer_resblocks_9_mlp_c_proj_bias";
     param_names_[122] = "transformer_resblocks_10_ln_1_weight";
     param_names_[123] = "transformer_resblocks_10_ln_1_bias";
     param_names_[124] = "transformer_resblocks_10_attn_qkv_weight";
     param_names_[125] = "transformer_resblocks_10_attn_cu_length";
     param_names_[126] = "transformer_resblocks_10_attn_proj_weight";
     param_names_[127] = "transformer_resblocks_10_attn_proj_bias";
     param_names_[128] = "transformer_resblocks_10_ln_2_weight";
     param_names_[129] = "transformer_resblocks_10_ln_2_bias";
     param_names_[130] = "transformer_resblocks_10_mlp_c_fc_weight";
     param_names_[131] = "transformer_resblocks_10_mlp_c_fc_bias";
     param_names_[132] = "transformer_resblocks_10_mlp_c_proj_weight";
     param_names_[133] = "transformer_resblocks_10_mlp_c_proj_bias";
     param_names_[134] = "transformer_resblocks_11_ln_1_weight";
     param_names_[135] = "transformer_resblocks_11_ln_1_bias";
     param_names_[136] = "transformer_resblocks_11_attn_qkv_weight";
     param_names_[137] = "transformer_resblocks_11_attn_cu_length";
     param_names_[138] = "transformer_resblocks_11_attn_proj_weight";
     param_names_[139] = "transformer_resblocks_11_attn_proj_bias";
     param_names_[140] = "transformer_resblocks_11_ln_2_weight";
     param_names_[141] = "transformer_resblocks_11_ln_2_bias";
     param_names_[142] = "transformer_resblocks_11_mlp_c_fc_weight";
     param_names_[143] = "transformer_resblocks_11_mlp_c_fc_bias";
     param_names_[144] = "transformer_resblocks_11_mlp_c_proj_weight";
     param_names_[145] = "transformer_resblocks_11_mlp_c_proj_bias";
     param_names_[1] = "output_0";
     param_dtypes_[0] = AITemplateDtype::kLong;
     param_dtypes_[2] = AITemplateDtype::kHalf;
     param_dtypes_[3] = AITemplateDtype::kHalf;
     param_dtypes_[4] = AITemplateDtype::kHalf;
     param_dtypes_[5] = AITemplateDtype::kInt;
     param_dtypes_[6] = AITemplateDtype::kHalf;
     param_dtypes_[7] = AITemplateDtype::kHalf;
     param_dtypes_[8] = AITemplateDtype::kHalf;
     param_dtypes_[9] = AITemplateDtype::kHalf;
     param_dtypes_[10] = AITemplateDtype::kHalf;
     param_dtypes_[11] = AITemplateDtype::kHalf;
     param_dtypes_[12] = AITemplateDtype::kHalf;
     param_dtypes_[13] = AITemplateDtype::kHalf;
     param_dtypes_[14] = AITemplateDtype::kHalf;
     param_dtypes_[15] = AITemplateDtype::kHalf;
     param_dtypes_[16] = AITemplateDtype::kHalf;
     param_dtypes_[17] = AITemplateDtype::kInt;
     param_dtypes_[18] = AITemplateDtype::kHalf;
     param_dtypes_[19] = AITemplateDtype::kHalf;
     param_dtypes_[20] = AITemplateDtype::kHalf;
     param_dtypes_[21] = AITemplateDtype::kHalf;
     param_dtypes_[22] = AITemplateDtype::kHalf;
     param_dtypes_[23] = AITemplateDtype::kHalf;
     param_dtypes_[24] = AITemplateDtype::kHalf;
     param_dtypes_[25] = AITemplateDtype::kHalf;
     param_dtypes_[26] = AITemplateDtype::kHalf;
     param_dtypes_[27] = AITemplateDtype::kHalf;
     param_dtypes_[28] = AITemplateDtype::kHalf;
     param_dtypes_[29] = AITemplateDtype::kInt;
     param_dtypes_[30] = AITemplateDtype::kHalf;
     param_dtypes_[31] = AITemplateDtype::kHalf;
     param_dtypes_[32] = AITemplateDtype::kHalf;
     param_dtypes_[33] = AITemplateDtype::kHalf;
     param_dtypes_[34] = AITemplateDtype::kHalf;
     param_dtypes_[35] = AITemplateDtype::kHalf;
     param_dtypes_[36] = AITemplateDtype::kHalf;
     param_dtypes_[37] = AITemplateDtype::kHalf;
     param_dtypes_[38] = AITemplateDtype::kHalf;
     param_dtypes_[39] = AITemplateDtype::kHalf;
     param_dtypes_[40] = AITemplateDtype::kHalf;
     param_dtypes_[41] = AITemplateDtype::kInt;
     param_dtypes_[42] = AITemplateDtype::kHalf;
     param_dtypes_[43] = AITemplateDtype::kHalf;
     param_dtypes_[44] = AITemplateDtype::kHalf;
     param_dtypes_[45] = AITemplateDtype::kHalf;
     param_dtypes_[46] = AITemplateDtype::kHalf;
     param_dtypes_[47] = AITemplateDtype::kHalf;
     param_dtypes_[48] = AITemplateDtype::kHalf;
     param_dtypes_[49] = AITemplateDtype::kHalf;
     param_dtypes_[50] = AITemplateDtype::kHalf;
     param_dtypes_[51] = AITemplateDtype::kHalf;
     param_dtypes_[52] = AITemplateDtype::kHalf;
     param_dtypes_[53] = AITemplateDtype::kInt;
     param_dtypes_[54] = AITemplateDtype::kHalf;
     param_dtypes_[55] = AITemplateDtype::kHalf;
     param_dtypes_[56] = AITemplateDtype::kHalf;
     param_dtypes_[57] = AITemplateDtype::kHalf;
     param_dtypes_[58] = AITemplateDtype::kHalf;
     param_dtypes_[59] = AITemplateDtype::kHalf;
     param_dtypes_[60] = AITemplateDtype::kHalf;
     param_dtypes_[61] = AITemplateDtype::kHalf;
     param_dtypes_[62] = AITemplateDtype::kHalf;
     param_dtypes_[63] = AITemplateDtype::kHalf;
     param_dtypes_[64] = AITemplateDtype::kHalf;
     param_dtypes_[65] = AITemplateDtype::kInt;
     param_dtypes_[66] = AITemplateDtype::kHalf;
     param_dtypes_[67] = AITemplateDtype::kHalf;
     param_dtypes_[68] = AITemplateDtype::kHalf;
     param_dtypes_[69] = AITemplateDtype::kHalf;
     param_dtypes_[70] = AITemplateDtype::kHalf;
     param_dtypes_[71] = AITemplateDtype::kHalf;
     param_dtypes_[72] = AITemplateDtype::kHalf;
     param_dtypes_[73] = AITemplateDtype::kHalf;
     param_dtypes_[74] = AITemplateDtype::kHalf;
     param_dtypes_[75] = AITemplateDtype::kHalf;
     param_dtypes_[76] = AITemplateDtype::kHalf;
     param_dtypes_[77] = AITemplateDtype::kInt;
     param_dtypes_[78] = AITemplateDtype::kHalf;
     param_dtypes_[79] = AITemplateDtype::kHalf;
     param_dtypes_[80] = AITemplateDtype::kHalf;
     param_dtypes_[81] = AITemplateDtype::kHalf;
     param_dtypes_[82] = AITemplateDtype::kHalf;
     param_dtypes_[83] = AITemplateDtype::kHalf;
     param_dtypes_[84] = AITemplateDtype::kHalf;
     param_dtypes_[85] = AITemplateDtype::kHalf;
     param_dtypes_[86] = AITemplateDtype::kHalf;
     param_dtypes_[87] = AITemplateDtype::kHalf;
     param_dtypes_[88] = AITemplateDtype::kHalf;
     param_dtypes_[89] = AITemplateDtype::kInt;
     param_dtypes_[90] = AITemplateDtype::kHalf;
     param_dtypes_[91] = AITemplateDtype::kHalf;
     param_dtypes_[92] = AITemplateDtype::kHalf;
     param_dtypes_[93] = AITemplateDtype::kHalf;
     param_dtypes_[94] = AITemplateDtype::kHalf;
     param_dtypes_[95] = AITemplateDtype::kHalf;
     param_dtypes_[96] = AITemplateDtype::kHalf;
     param_dtypes_[97] = AITemplateDtype::kHalf;
     param_dtypes_[98] = AITemplateDtype::kHalf;
     param_dtypes_[99] = AITemplateDtype::kHalf;
     param_dtypes_[100] = AITemplateDtype::kHalf;
     param_dtypes_[101] = AITemplateDtype::kInt;
     param_dtypes_[102] = AITemplateDtype::kHalf;
     param_dtypes_[103] = AITemplateDtype::kHalf;
     param_dtypes_[104] = AITemplateDtype::kHalf;
     param_dtypes_[105] = AITemplateDtype::kHalf;
     param_dtypes_[106] = AITemplateDtype::kHalf;
     param_dtypes_[107] = AITemplateDtype::kHalf;
     param_dtypes_[108] = AITemplateDtype::kHalf;
     param_dtypes_[109] = AITemplateDtype::kHalf;
     param_dtypes_[110] = AITemplateDtype::kHalf;
     param_dtypes_[111] = AITemplateDtype::kHalf;
     param_dtypes_[112] = AITemplateDtype::kHalf;
     param_dtypes_[113] = AITemplateDtype::kInt;
     param_dtypes_[114] = AITemplateDtype::kHalf;
     param_dtypes_[115] = AITemplateDtype::kHalf;
     param_dtypes_[116] = AITemplateDtype::kHalf;
     param_dtypes_[117] = AITemplateDtype::kHalf;
     param_dtypes_[118] = AITemplateDtype::kHalf;
     param_dtypes_[119] = AITemplateDtype::kHalf;
     param_dtypes_[120] = AITemplateDtype::kHalf;
     param_dtypes_[121] = AITemplateDtype::kHalf;
     param_dtypes_[122] = AITemplateDtype::kHalf;
     param_dtypes_[123] = AITemplateDtype::kHalf;
     param_dtypes_[124] = AITemplateDtype::kHalf;
     param_dtypes_[125] = AITemplateDtype::kInt;
     param_dtypes_[126] = AITemplateDtype::kHalf;
     param_dtypes_[127] = AITemplateDtype::kHalf;
     param_dtypes_[128] = AITemplateDtype::kHalf;
     param_dtypes_[129] = AITemplateDtype::kHalf;
     param_dtypes_[130] = AITemplateDtype::kHalf;
     param_dtypes_[131] = AITemplateDtype::kHalf;
     param_dtypes_[132] = AITemplateDtype::kHalf;
     param_dtypes_[133] = AITemplateDtype::kHalf;
     param_dtypes_[134] = AITemplateDtype::kHalf;
     param_dtypes_[135] = AITemplateDtype::kHalf;
     param_dtypes_[136] = AITemplateDtype::kHalf;
     param_dtypes_[137] = AITemplateDtype::kInt;
     param_dtypes_[138] = AITemplateDtype::kHalf;
     param_dtypes_[139] = AITemplateDtype::kHalf;
     param_dtypes_[140] = AITemplateDtype::kHalf;
     param_dtypes_[141] = AITemplateDtype::kHalf;
     param_dtypes_[142] = AITemplateDtype::kHalf;
     param_dtypes_[143] = AITemplateDtype::kHalf;
     param_dtypes_[144] = AITemplateDtype::kHalf;
     param_dtypes_[145] = AITemplateDtype::kHalf;
     param_dtypes_[1] = AITemplateDtype::kHalf;
     max_param_shapes_[0] = {1, 77};
     max_param_shapes_[2] = {512};
     max_param_shapes_[3] = {512};
     max_param_shapes_[4] = {1536, 512};
     max_param_shapes_[5] = {2};
     max_param_shapes_[6] = {512, 512};
     max_param_shapes_[7] = {512};
     max_param_shapes_[8] = {512};
     max_param_shapes_[9] = {512};
     max_param_shapes_[10] = {2048, 512};
     max_param_shapes_[11] = {2048};
     max_param_shapes_[12] = {512, 2048};
     max_param_shapes_[13] = {512};
     max_param_shapes_[14] = {512};
     max_param_shapes_[15] = {512};
     max_param_shapes_[16] = {1536, 512};
     max_param_shapes_[17] = {2};
     max_param_shapes_[18] = {512, 512};
     max_param_shapes_[19] = {512};
     max_param_shapes_[20] = {512};
     max_param_shapes_[21] = {512};
     max_param_shapes_[22] = {2048, 512};
     max_param_shapes_[23] = {2048};
     max_param_shapes_[24] = {512, 2048};
     max_param_shapes_[25] = {512};
     max_param_shapes_[26] = {512};
     max_param_shapes_[27] = {512};
     max_param_shapes_[28] = {1536, 512};
     max_param_shapes_[29] = {2};
     max_param_shapes_[30] = {512, 512};
     max_param_shapes_[31] = {512};
     max_param_shapes_[32] = {512};
     max_param_shapes_[33] = {512};
     max_param_shapes_[34] = {2048, 512};
     max_param_shapes_[35] = {2048};
     max_param_shapes_[36] = {512, 2048};
     max_param_shapes_[37] = {512};
     max_param_shapes_[38] = {512};
     max_param_shapes_[39] = {512};
     max_param_shapes_[40] = {1536, 512};
     max_param_shapes_[41] = {2};
     max_param_shapes_[42] = {512, 512};
     max_param_shapes_[43] = {512};
     max_param_shapes_[44] = {512};
     max_param_shapes_[45] = {512};
     max_param_shapes_[46] = {2048, 512};
     max_param_shapes_[47] = {2048};
     max_param_shapes_[48] = {512, 2048};
     max_param_shapes_[49] = {512};
     max_param_shapes_[50] = {512};
     max_param_shapes_[51] = {512};
     max_param_shapes_[52] = {1536, 512};
     max_param_shapes_[53] = {2};
     max_param_shapes_[54] = {512, 512};
     max_param_shapes_[55] = {512};
     max_param_shapes_[56] = {512};
     max_param_shapes_[57] = {512};
     max_param_shapes_[58] = {2048, 512};
     max_param_shapes_[59] = {2048};
     max_param_shapes_[60] = {512, 2048};
     max_param_shapes_[61] = {512};
     max_param_shapes_[62] = {512};
     max_param_shapes_[63] = {512};
     max_param_shapes_[64] = {1536, 512};
     max_param_shapes_[65] = {2};
     max_param_shapes_[66] = {512, 512};
     max_param_shapes_[67] = {512};
     max_param_shapes_[68] = {512};
     max_param_shapes_[69] = {512};
     max_param_shapes_[70] = {2048, 512};
     max_param_shapes_[71] = {2048};
     max_param_shapes_[72] = {512, 2048};
     max_param_shapes_[73] = {512};
     max_param_shapes_[74] = {512};
     max_param_shapes_[75] = {512};
     max_param_shapes_[76] = {1536, 512};
     max_param_shapes_[77] = {2};
     max_param_shapes_[78] = {512, 512};
     max_param_shapes_[79] = {512};
     max_param_shapes_[80] = {512};
     max_param_shapes_[81] = {512};
     max_param_shapes_[82] = {2048, 512};
     max_param_shapes_[83] = {2048};
     max_param_shapes_[84] = {512, 2048};
     max_param_shapes_[85] = {512};
     max_param_shapes_[86] = {512};
     max_param_shapes_[87] = {512};
     max_param_shapes_[88] = {1536, 512};
     max_param_shapes_[89] = {2};
     max_param_shapes_[90] = {512, 512};
     max_param_shapes_[91] = {512};
     max_param_shapes_[92] = {512};
     max_param_shapes_[93] = {512};
     max_param_shapes_[94] = {2048, 512};
     max_param_shapes_[95] = {2048};
     max_param_shapes_[96] = {512, 2048};
     max_param_shapes_[97] = {512};
     max_param_shapes_[98] = {512};
     max_param_shapes_[99] = {512};
     max_param_shapes_[100] = {1536, 512};
     max_param_shapes_[101] = {2};
     max_param_shapes_[102] = {512, 512};
     max_param_shapes_[103] = {512};
     max_param_shapes_[104] = {512};
     max_param_shapes_[105] = {512};
     max_param_shapes_[106] = {2048, 512};
     max_param_shapes_[107] = {2048};
     max_param_shapes_[108] = {512, 2048};
     max_param_shapes_[109] = {512};
     max_param_shapes_[110] = {512};
     max_param_shapes_[111] = {512};
     max_param_shapes_[112] = {1536, 512};
     max_param_shapes_[113] = {2};
     max_param_shapes_[114] = {512, 512};
     max_param_shapes_[115] = {512};
     max_param_shapes_[116] = {512};
     max_param_shapes_[117] = {512};
     max_param_shapes_[118] = {2048, 512};
     max_param_shapes_[119] = {2048};
     max_param_shapes_[120] = {512, 2048};
     max_param_shapes_[121] = {512};
     max_param_shapes_[122] = {512};
     max_param_shapes_[123] = {512};
     max_param_shapes_[124] = {1536, 512};
     max_param_shapes_[125] = {2};
     max_param_shapes_[126] = {512, 512};
     max_param_shapes_[127] = {512};
     max_param_shapes_[128] = {512};
     max_param_shapes_[129] = {512};
     max_param_shapes_[130] = {2048, 512};
     max_param_shapes_[131] = {2048};
     max_param_shapes_[132] = {512, 2048};
     max_param_shapes_[133] = {512};
     max_param_shapes_[134] = {512};
     max_param_shapes_[135] = {512};
     max_param_shapes_[136] = {1536, 512};
     max_param_shapes_[137] = {2};
     max_param_shapes_[138] = {512, 512};
     max_param_shapes_[139] = {512};
     max_param_shapes_[140] = {512};
     max_param_shapes_[141] = {512};
     max_param_shapes_[142] = {2048, 512};
     max_param_shapes_[143] = {2048};
     max_param_shapes_[144] = {512, 2048};
     max_param_shapes_[145] = {512};
     max_param_shapes_[1] = {1, 77, 512};
  for (size_t i = 0; i < num_params_; ++i) {
    max_param_numel_[i] = std::accumulate(
      max_param_shapes_[i].begin(),
      max_param_shapes_[i].end(),
      1,
      std::multiplies<int64_t>()
    );
    max_param_storage_bytes_[i] = max_param_numel_[i] * AITemplateDtypeSizeBytes(param_dtypes_[i]);
  }

  auto* constants_ptr = static_cast<uint8_t*>(constants_.get());
  DEVICE_CHECK(DeviceMemset(constants_ptr, 0, params_size));
  const auto binary_constants_bin_size = static_cast<size_t>(_binary_constants_bin_end - _binary_constants_bin_start);
  for (auto& constant_info : owned_constants) {
    auto* dst = constants_ptr + constant_info.internal_offset;
    if (constant_info.data_offset + constant_info.num_bytes > binary_constants_bin_size) {
      throw std::runtime_error(std::string("Copying constant ") + constant_info.name + " would overflow constant buffer");
    }
    DEVICE_CHECK(CopyToDevice(dst, _binary_constants_bin_start + constant_info.data_offset, constant_info.num_bytes));
  }
}

ModelContainer* CreateModelContainer(size_t num_runtimes) {
  // num_runtimes, blob_size, workspace_size, num_inputs, num_outputs, num_unbound_constants, param_size
  return new ModelContainer(num_runtimes, 630784, 161792, 1, 1, 144, 50674688);
}
} // namespace ait